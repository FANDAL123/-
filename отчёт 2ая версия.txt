ФЕДЕРАЛЬНОЕ АГЕНТСТВО ВОЗДУШНОГО ТРАНСПОРТА (РОСАВИАЦИЯ) ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ БЮДЖЕТНОЕ ОБРАЗОВАТЕЛЬНОЕ УЧРЕЖДЕНИЕ ВЫСШЕГО ОБРАЗОВАНИЯ «САНКТ-ПЕТЕРБУРГСКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ ГРАЖДАНСКОЙ АВИАЦИИ ИМЕНИ ГЛАВНОГО МАРШАЛА АВИАЦИИ А.А. НОВИКОВА»

ДИСЦИПЛИНА: Эконометрика. Анализ данных и машинное обучение
Отчет о проделанной работе
Выполнил : Маньковский Матвей группа ЦЭВТ 24-01, 2 курс, очная форма обучения Преподаватель: Земсков Юрий Владимирович
Санкт-Петербург, 2025 г.
АНАЛИЗ СЛУЧАЙНЫХ ЧИСЕЛ, ГИСТОГРАММЫ И ОПИСАТЕЛЬНОЙ СТАТИСТИКИ

Подготовка данных
Для генерации 1000 случайных величин, имеющих нормальное распределение, была применена функция:
=НОРМ.ОБР(СЛЧИС(); μ; σ)
где:

μ = 10 (параметр задан в ячейке),

σ = 4 (параметр задан в ячейке).

Сгенерированные данные были размещены в диапазоне ячеек.

Построение гистограммы
Для исследования распределения данных были осуществлены следующие действия:

Определено 15 интервалов от минимального до максимального значения в выборке.

Рассчитана ширина интервала и левые границы каждого из них.

Для подсчёта частот применена формула массива: =ЧАСТОТА
Результаты размещены в столбце .

На основе диапазона построена гистограмма с группировкой.

При нажатии F9 данные обновлялись, что давало возможность наблюдать различные реализации выборок, соответствующих одному и тому же нормальному закону распределения.

[Место для скриншота работы]

Выводы
В рамках данной части работы были сгенерированы случайные числа, имеющие нормальное распределение, построена гистограмма частот и вычислены ключевые статистические характеристики выборки.

Полученные итоги подтвердили следующие положения:

Распределение выборки является близким к нормальному (гистограмма обладает колоколообразной формой).

Значение коэффициента асимметрии близко к нулю, что характерно для нормального распределения.

Среднее арифметическое и медиана также находятся близко друг к другу, что соответствует свойству симметричности распределения.

Работа способствовала закреплению практических навыков применения Excel для статистического анализа данных, включая использование формул массива и визуализацию результатов.

================================================================================

АНАЛИЗ ПАРНОЙ КОРРЕЛЯЦИИ

Исходные данные
Были использованы данные, содержащие 40 наблюдений по переменным x и y. Для анализа применялись расчёты:

x^2, y^2, xy

Теоретическое значение y_теор = -200 + 70 * ln(x)

Квадраты отклонений: (y_теор - y)^2 и (y - y_ср)^2

Суммы и средние значения по всем столбцам.

Линейный коэффициент парной корреляции r_xy
Линейный коэффициент корреляции вычисляется по формуле:
r_xy = [n * Σxy - Σx * Σy] / sqrt( [n * Σx^2 - (Σx)^2] * [n * Σy^2 - (Σy)^2] )
где n = 40.

На основе суммирования данных из таблицы было получено значение:
r_xy ≈ 0.942
Это свидетельствует о наличии сильной положительной линейной зависимости между переменными.

Индекс корреляции R
Индекс корреляции для нелинейной (логарифмической) модели был рассчитан по формуле:
R = sqrt( 1 - Σ(y_теор - y)^2 / Σ(y - y_ср)^2 )
Используя вычисленные суммы, получено:
R ≈ 0.958
Это указывает на несколько более тесную связь в рамках логарифмической модели по сравнению с линейной.

Проверка значимости r_xy
Рассчитано наблюдаемое значение t-критерия:
t_набл = (r_xy * sqrt(n-2)) / sqrt(1 - r_xy^2) ≈ 16.24
Табличное значение t_крит при α = 0.05 и df = 38 составляет t_крит ≈ 2.024.
Поскольку |t_набл| > t_крит, коэффициент r_xy является статистически значимым.

Проверка значимости индекса корреляции R
Рассчитано наблюдаемое значение F-критерия:
F_набл = (R^2 / 1) / ((1 - R^2) / (n - 2)) ≈ 421.5
Табличное значение F_крит при α = 0.05, df1 = 1, df2 = 38 составляет F_крит ≈ 4.10.
Поскольку F_набл > F_крит, индекс корреляции R также является значимым.

Построение доверительного интервала для r_xy
Поскольку коэффициент r_xy значим, был построен 95% доверительный интервал с использованием Z-преобразования Фишера:
z' = 0.5 * ln( (1+r) / (1-r) ) ≈ 1.757; σ_z' = 1 / sqrt(n-3) ≈ 0.164
Доверительный интервал для z':
z' ± z_0.975 * σ_z' = [1.436; 2.078]
После обратного преобразования получен интервал для r:
r ∈ [0.891; 0.969]

[Место для скриншота работы]

Выводы

Между переменными x и y существует сильная положительная связь, подтверждённая как линейным коэффициентом корреляции r_xy = 0.942, так и индексом корреляции R = 0.958.

Оба показателя являются статистически значимыми на уровне α = 0.05.

Логарифмическая модель y_теор = -200 + 70 * ln(x) описывает взаимосвязь несколько лучше, чем линейная.

Доверительный интервал для значимого коэффициента r_xy составляет [0.891; 0.969], что подтверждает высокую степень линейной зависимости.

================================================================================

ПОСТРОЕНИЕ ПАРНОЙ РЕГРЕССИИ

Исходные данные и инструменты

Данные: предоставлены 45 наблюдений по двум переменным: x (факторный признак) и y (результативный признак).

Построение уравнений регрессии
На основании данных были построены две регрессионные модели:

Линейная модель: y = a + b * x. Параметры a и b были рассчитаны по методу наименьших квадратов (МНК) с использованием формул на основе сумм столбцов x, y, x^2, y^2, xy.

Логарифмическая модель: y = a + b * ln(x). Для её построения предварительно были рассчитаны натуральные логарифмы переменной x (столбец ln(x)). Затем по МНК были оценены параметры a и b для уравнения с преобразованной переменной.

Вычисление показателей качества и точности
Для каждой из построенных моделей были рассчитаны следующие показатели:

Теоретические значения y_теор.

Остатки (y_теор - y) и их квадраты (y_теор - y)^2.

Общая сумма квадратов отклонений (y - y_ср)^2, где y_ср — среднее значение y.

Коэффициент детерминации R^2. Этот показатель отражает долю дисперсии y, объяснённую моделью.

Средняя ошибка аппроксимации A, %: Рассчитывалась как среднее арифметическое относительных абсолютных отклонений. Показатель отражает среднюю точность модели в процентах.

Стандартная ошибка регрессии S: Оценка среднего отклонения фактических точек от линии регрессии.

F-статистика: Рассчитывалась для проверки значимости регрессии в целом.

Проверка значимости уравнений регрессии

Для каждого уравнения по рассчитанной F-статистике и табличным критическим значениям F (для α = 0.05 и α = 0.01) была проверена гипотеза о статистической незначимости модели (H0: R^2 = 0).

Поскольку расчётное F > F_кр, гипотеза H0 отвергается, и оба уравнения регрессии признаны статистически значимыми на обоих уровнях.

Выбор лучшего уравнения регрессии

Основным критерием выбора лучшей модели, согласно заданию, является средняя ошибка аппроксимации (A%). Модель с меньшим значением A считается более точной.

После сравнения значений A% для линейной и логарифмической моделей лучшей была признана модель с минимальной средней ошибкой аппроксимации.

Дополнительный анализ линейной регрессии
Для линейной модели дополнительно было выполнено:

Проверка значимости коэффициентов (a, b): Рассчитаны t-статистики для каждого коэффициента и проведено сравнение с табличным t_крит для α = 0.05. Подтверждено, что оба коэффициента значимо отличаются от нуля.

Построение доверительных интервалов для параметров: Рассчитаны стандартные ошибки коэффициентов и построены интервалы для параметров a и b с надёжностью 95%.

Прогнозирование:

Точечный прогноз: Подстановка x = x_max в уравнение линейной регрессии для получения точечного прогнозного значения y_пр.

Интервальный прогноз: Расчёт стандартной ошибки прогноза и построение доверительного интервала для индивидуального значения y при x = x_max с уровнем значимости 0.05.

Расчёт среднего коэффициента эластичности: Показатель, отражающий, на сколько процентов в среднем изменится y при изменении x на 1%.

Визуализация в Excel:

Построено поле корреляции с нанесением линий обеих регрессий для визуальной оценки качества аппроксимации.

Построен график остатков от теоретических значений для лучшей модели с целью проверки предпосылок МНК (случайность и гомоскедастичность остатков).

[Место для скриншота работы]

Выводы

В ходе работы были успешно построены и проанализированы две модели парной регрессии: линейная и логарифмическая.

Обе модели являются статистически значимыми (гипотеза об отсутствии связи отвергается на уровнях 0.05 и 0.01).

На основе критерия минимальной средней ошибки аппроксимации была выбрана лучшая модель.

Для линейной модели подтверждена значимость её коэффициентов. Доверительные интервалы для параметров показывают диапазоны их возможных значений.

Прогнозное значение для x = x_max по линейной модели составляет y_пр с 95%-ным доверительным интервалом от [нижняя граница] до [верхняя граница].

Графики наглядно подтверждают адекватность выбранной модели и отсутствие в остатках явных систематических закономерностей.

================================================================================

ПОСТРОЕНИЕ МНОЖЕСТВЕННОЙ РЕГРЕССИИ

Исходные данные

Объём выборки: n = 25 стран.

Переменные:

y – индекс человеческого развития (среднее y_ср = 0.85, σ_y = 0.1);

x1 – суточная калорийность питания (среднее x1_ср = 3179.24, σ_x1 = 321.6);

x2 – ожидаемая продолжительность жизни (среднее x2_ср = 74.42, σ_x2 = 4.8).

Парные коэффициенты корреляции:
r_yx1 = 0.75, r_yx2 = 0.96, r_x1x2 = 0.7.

Построение уравнения множественной линейной регрессии

Рассчитаны β-коэффициенты:
β1 ≈ 0.153, β2 ≈ 0.853.

Уравнение в стандартизованном виде:
t_y = 0.153 * t_x1 + 0.853 * t_x2.
Вывод: Вклад x2 (продолжительность жизни) в объяснение вариации y существенно выше, чем вклад x1 (калорийность).

Рассчитаны коэффициенты уравнения в естественной форме:
b1 ≈ 4.754 * 10^(-5), b2 ≈ 0.01777, a ≈ -0.6231.

Уравнение в естественной форме:
y = -0.6231 + 4.754*10^(-5) * x1 + 0.01777 * x2
Вывод: При увеличении калорийности на 100 ккал/сутки индекс человеческого развития возрастает приблизительно на 0.00475 пункта (при фиксированной x2). При росте продолжительности жизни на 1 год индекс увеличивается примерно на 0.0178 пункта.

Частные коэффициенты эластичности

Э1 ≈ 0.178, Э2 ≈ 1.556.

При росте калорийности на 1% индекс увеличивается на 0.178% (при постоянной x2).

При росте продолжительности жизни на 1% индекс увеличивается на 1.556% (при постоянной x1).

Фактор x2 является значительно более эластичным по своему влиянию на y.

Линейные коэффициенты частной корреляции и множественный коэффициент корреляции

r_yx1·x2 ≈ 0.390 — связь y и x1 при исключении влияния x2 является умеренной.

r_yx2·x1 ≈ 0.921 — связь y и x2 при исключении влияния x1 остаётся очень сильной.

Множественный коэффициент корреляции R ≈ 0.966 (R^2 ≈ 0.9335).
Модель объясняет около 93.35% вариации y.

Проверка значимости уравнения регрессии (F-тест)

F_расч ≈ 154.5, F_табл(2, 22; 0.05) ≈ 3.44.

Поскольку F_расч > F_табл, уравнение регрессии является статистически значимым в целом на уровне значимости 5%.

[Место для скриншота работы]

Выводы

Оба фактора (x1, x2) оказывают положительное влияние на индекс человеческого развития.

Наибольший вклад вносит продолжительность жизни (x2) — как по значению β-коэффициента, так и по коэффициенту эластичности.

Калорийность питания (x1) обладает слабым самостоятельным влиянием после учёта x2 (низкий коэффициент частной корреляции).

Построенная модель обладает высокой объясняющей способностью и является статистически значимой.

================================================================================

ДИАГНОСТИКА НАРУШЕНИЙ ДОПУЩЕНИЙ В МНОЖЕСТВЕННОЙ РЕГРЕССИИ

Исходные данные
Для анализа использовалось уравнение множественной линейной регрессии, построенное по данным 25 стран:
y = -0.6231 + 0.00004755 * x1 + 0.01777 * x2
где:

y — индекс человеческого развития,

x1 — суточная калорийность питания (ккал/чел.),

x2 — ожидаемая продолжительность жизни (лет).

Основные характеристики модели:

Коэффициент множественной корреляции: R = 0.966

Коэффициент детерминации: R^2 = 0.9335

F-статистика: 154.5 (модель значима при α = 0.05)

Проверка на гетероскедастичность
2.1 Тест Голдфелда-Квандта

Данные упорядочены по возрастанию переменной x1.

Исключено 8 центральных наблюдений (c ≈ n/3).

Оценены регрессии для первой и последней групп по 8 наблюдений.
Результаты:

RSS1 = 0.0020 (остаточная сумма квадратов первой группы)

RSS2 = 0.0120 (остаточная сумма квадратов второй группы)

F = RSS2 / RSS1 = 0.0120 / 0.0020 = 6.0
Вывод:
F_расч = 6.0 > F_крит(5,5; 0.05) = 5.05
Гипотеза о гомоскедастичности отвергается. Обнаружены признаки роста дисперсии остатков с увеличением x1.

2.2 Тест ранговой корреляции Спирмена

Вычислены абсолютные значения остатков |e_i|.

Определены ранги для |e_i| и x1_i.

Рассчитан коэффициент ранговой корреляции.
Результаты:

Коэффициент Спирмена: r_s = 0.40

Тестовая статистика: t = (r_s * sqrt(n-2)) / sqrt(1 - r_s^2) ≈ 2.09
Вывод:
t_расч = 2.09 > t_крит(0.025; 23) = 2.069
Обнаружена статистически значимая связь между абсолютными остатками и переменной x1, что указывает на наличие гетероскедастичности.

2.3 Тест Уайта

Построена вспомогательная регрессия квадратов остатков от исходных регрессоров и их комбинаций.

Рассчитан коэффициент детерминации вспомогательной модели.
Результаты:

Коэффициент детерминации: R^2_aux = 0.35

Статистика Уайта: W = n * R^2_aux = 25 * 0.35 = 8.75
Вывод:
W_расч = 8.75 < χ^2_крит(5; 0.05) = 11.07
Гипотеза о наличии гетероскедастичности не отвергается на уровне значимости 0.05.

2.4 Общий вывод по гетероскедастичности
Два из трёх проведённых тестов указывают на присутствие гетероскедастичности в остатках модели.

Проверка на автокорреляцию
3.1 Критерий Дарбина-Уотсона

Вычислена последовательность разностей остатков.

Рассчитана статистика DW.
Результаты:
DW = Σ (e_t - e_{t-1})^2 / Σ e_t^2 = 1.50

Критические значения для n=25, k=2: d_L = 1.12, d_U = 1.66.
Вывод:
d_L < DW < d_U (1.12 < 1.50 < 1.66)
Результат попадает в зону неопределённости. Требуются дополнительные тесты.

3.2 Q-статистика Льюинга-Бокса
Результаты:

Автокорреляции: r1 = 0.30, r2 = 0.20, r3 = -0.10, r4 = 0.05

Q = n * (n+2) * Σ (r_j^2 / (n - j)) ≈ 4.09
Вывод:
Q_расч = 4.09 < χ^2_крит(4; 0.05) = 9.49
Гипотеза об отсутствии автокорреляции не отвергается.

3.3 Общий вывод по автокорреляции
Результаты тестов не дают однозначного заключения:

Критерий Дарбина-Уотсона: зона неопределённости.

Q-статистика Льюинга-Бокса: автокорреляция остатков отсутствует.

[Место для скриншота работы]

Выводы
Проведённая диагностика остатков регрессионной модели выявила:

Наличие гетероскедастичности, что требует коррекции стандартных ошибок коэффициентов для валидности статистических выводов.

Отсутствие явной автокорреляции остатков — модель адекватна по этому критерию.

Модель в целом удовлетворительно описывает зависимость индекса человеческого развития от факторов питания и продолжительности жизни, однако для корректных статистических выводов необходимо учесть выявленную гетероскедастичность.

================================================================================

АНАЛИЗ НЕЛИНЕЙНОЙ РЕГРЕССИИ И СПОСОБЫ ЕЁ РЕАЛИЗАЦИИ

Краткое описание работы
В ходе выполнения задания был проведён корреляционно-регрессионный анализ зависимости расходов на питание и непродовольственные товары y от среднемесячного дохода x для 11 семей.

Основные этапы работы

Оценены параметры трёх нелинейных моделей: степенной, показательной и равносторонней гиперболы.

Для каждой модели рассчитан индекс корреляции и коэффициент детерминации R^2.

Проверена статистическая значимость моделей с помощью F-критерия Фишера при уровне значимости α = 0.05.

Оценена точность моделей через среднюю ошибку аппроксимации.

[Место для скриншота работы]

Выводы

Степенная модель y = 0.268 * x^1.444 показала наилучшее качество аппроксимации: R^2 ≈ 0.75, ошибка аппроксимации минимальна.

Показательная модель y = 4.198 * e^(0.0303x) объясняет около 71% вариации расходов.

Гиперболическая модель y = 2.923 + 26.93/x имеет R^2 ≈ 0.65 и наибольшую среднюю ошибку.

Все модели являются статистически значимыми согласно F-критерию.

Экономический вывод: Степенная модель наиболее адекватно отражает зависимость расходов от дохода. Коэффициент эластичности b ≈ 1.444 > 1 означает, что при увеличении дохода на 1% расходы растут на 1.444%, что может свидетельствовать об опережающем росте доли расходов на непродовольственные товары с ростом благосостояния семей.

================================================================================

АНАЛИЗ ДАННЫХ В СРЕДЕ R

Загрузка и первичный анализ данных
В начале работы был загружен встроенный датасет mtcars, содержащий характеристики 32 автомобилей. Для ознакомления со структурой данных использовались функции str(), summary() и head().

Выявлено:

Датасет состоит из 32 наблюдений и 11 переменных.

Большинство переменных являются числовыми (num), что упростило дальнейший анализ.

Переменные включают такие показатели, как расход топлива (mpg), мощность двигателя (hp), вес автомобиля (wt) и другие технические характеристики.

Анализ расхода топлива (mpg)
Рассчитаны основные описательные статистики для переменной mpg (расход топлива в милях на галлон):

Среднее значение: 20.09 миль на галлон

Медиана: 19.20 миль на галлон

Стандартное отклонение: 6.03

Минимум: 10.40 миль на галлон

Максимум: 33.90 миль на галлон

Первый квартиль (Q1) = 15.43, третий квартиль (Q3) = 22.80
Вывод: Расход топлива у автомобилей в выборке варьируется значительно. Средний расход составляет около 20 миль на галлон, но разброс значений велик. Медиана ниже среднего, что указывает на правостороннюю асимметрию распределения.

Создание новой переменной kpl
Для перевода расхода топлива в метрическую систему создана новая переменная kpl (километры на литр), с использованием коэффициента преобразования 1 миля на галлон = 0.425 км на литр.
Результат: Среднее значение новой переменной составило 8.55 км на литр.

Анализ распределения мощности двигателя (hp)
Построена гистограмма распределения переменной hp (мощность в лошадиных силах) с 10 интервалами. Добавлена вертикальная линия, обозначающая среднее значение (146.69 л.с.).
Наблюдения:

Большинство автомобилей (около 70%) имеют мощность в диапазоне 50–150 л.с.

Присутствуют несколько автомобилей с аномально высокой мощностью (свыше 200–300 л.с.), которые формируют «длинный хвост» распределения.

Средняя мощность не является типичной (репрезентативной) для большинства автомобилей в выборке из-за влияния выбросов.

Анализ зависимости расхода топлива от веса автомобиля
Для изучения взаимосвязи между весом автомобиля (wt) и расходом топлива (mpg) построена диаграмма рассеяния с линией тренда.
Выявленная зависимость:

Обнаружена сильная отрицательная корреляция (коэффициент корреляции Пирсона = -0.87).

Чем тяжелее автомобиль, тем выше расход топлива (меньше значение mpg).

Линия тренда демонстрирует линейную зависимость: с увеличением веса на 1 тыс. фунтов расход топлива снижается примерно на 5–6 миль на галлон.

Итоговые выводы
В результате проведённого анализа сделаны следующие выводы:

Датасет mtcars хорошо структурирован и удобен для анализа.

Топливная экономичность автомобилей сильно варьируется, что связано с их техническими характеристиками.

Мощность двигателя распределена неравномерно, с наличием «элитной» группы высокомощных автомобилей.

Вес автомобиля является одним из ключевых факторов, влияющих на расход топлива.

Полученные результаты могут быть полезны для сравнительного анализа автомобилей, прогнозирования расхода топлива и поддержки решений при выборе транспортного средства.